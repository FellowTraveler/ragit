# ragit-server

A bare-minimum server for self-hosting. You can push/clone knowledge-bases.

There's no frontend. You have to write one on your own.

## This is not production-ready

You can self-host `ragit-server` and it must be quite useful. But it's not production-ready!

- Auth
  - It does not implement any kind of Auth. There is `fn auth() -> bool;`, but its body is empty.
- Scalability
  - It does not use any kind of DB. It stores everything on disk. This design makes self-hosting simpler, but not suitable for large-scale services.

## Endpoints

- GET `/{user-name}/{repo-name}/index`
  - application/json: index.json
- GET `/{user-name}/{repo-name}/config/{config-name}`
  - application/json: {config-name}.json
- GET `/{user-name}/{repo-name}/prompt/{prompt-name}`
  - text/plain: {prompt-name}.pdl
- GET `/{user-name}/{repo-name}/chunk-count`
  - application/json: an integer
- GET `/{user-name}/{repo-name}/chunk-list/{uid-prefix}`
  - application/json: array[string]
  - It returns chunk uids that start with {uid-prefix}.
  - {uid-prefix} must be exactly 2 characters.
- GET `/{user-name}/{repo-name}/chunk-list`
  - application/json: array[string]
  - It returns all the chunk uids.
- GET `/{user-name}/{repo-name}/chunk/{chunk-uid}`
  - application/json: a chunk
  - `chunk::load_from_file()` can also deserialize this data.
- GET `/{user-name}/{repo-name}/archive-list`
  - application/json: array[string]
- GET `/{user-name}/{repo-name}/archive/{archive-key}`
  - application/octet-stream: a file generated by `rag archive-create`
- GET `/{user-name}/{repo-name}/image-list/{uid-prefix}`
  - application/json: array[string]
  - It returns image uids that start with {uid-prefix}.
  - {uid-prefix} must be exactly 2 characters.
- GET `/{user-name}/{repo-name}/image/{image-uid}`
  - image/png
- GET `/{user-name}/{repo-name}/image-desc/{image-uid}`
  - application/json: { extracted_text: string, explanation: string }
- GET `/{user-name}/{repo-name}/meta`
  - application/json: meta.json
- GET `/{user-name}/{repo-name}/version`
  - text/plain
  - "{major}.{minor}.{patch}"
  - "{major}.{minor}.{patch}-dev"
- GET `/version`
  - text/plain
  - "{major}.{minor}.{patch}"
  - "{major}.{minor}.{patch}-dev"
- POST `/{user-name}/{repo-name}/begin-push`
  - text/plain: a session id
- POST `/{user-name}/{repo-name}/archive`
  - request body (multiform): { "session-id": str, "archive-id": str, "archive": bytes }
- POST `/{user-name}/{repo-name}/finalize-push`
  - request body (plain text): session-id
